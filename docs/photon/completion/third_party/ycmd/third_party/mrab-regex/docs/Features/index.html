
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Introduction &#8212; PHOTON platform&lt;br/&gt;•&lt;br/&gt;.vim  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/photonsphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/graphviz.css" />
    <script data-url_root="../../../../../../../../" id="documentation_options" src="../../../../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../../../../_static/jquery.js"></script>
    <script src="../../../../../../../../_static/underscore.js"></script>
    <script src="../../../../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../../../../../_static/doctools.js"></script>
    <script src="../../../../../../../../_static/sphinx_highlight.js"></script>
    <link rel="canonical" href="https://photon-platform.github.io/vim/photon/completion/third_party/ycmd/third_party/mrab-regex/docs/Features.html" />
    <link rel="index" title="Index" href="../../../../../../../../genindex/" />
    <link rel="search" title="Search" href="../../../../../../../../search/" /> 
   
  <link rel="stylesheet" href="../../../../../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />
 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../../../../../../../log/atom.xml"
  title="PHOTON platform • .vim"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
             <section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h1>
<p>This regex implementation is backwards-compatible with the standard ‘re’ module, but offers additional functionality.</p>
</section>
<section id="note">
<h1>Note<a class="headerlink" href="#note" title="Permalink to this heading">¶</a></h1>
<p>The re module’s behaviour with zero-width matches changed in Python 3.7, and this module will follow that behaviour when compiled for Python 3.7.</p>
</section>
<section id="old-vs-new-behaviour">
<h1>Old vs new behaviour<a class="headerlink" href="#old-vs-new-behaviour" title="Permalink to this heading">¶</a></h1>
<p>In order to be compatible with the re module, this module has 2 behaviours:</p>
<ul>
<li><p><strong>Version 0</strong> behaviour (old behaviour, compatible with the re module):</p>
<p>Please note that the re module’s behaviour may change over time, and I’ll endeavour to match that behaviour in version 0.</p>
<ul class="simple">
<li><p>Indicated by the <code class="docutils literal notranslate"><span class="pre">VERSION0</span></code> or <code class="docutils literal notranslate"><span class="pre">V0</span></code> flag, or <code class="docutils literal notranslate"><span class="pre">(?V0)</span></code> in the pattern.</p></li>
<li><p>Zero-width matches are not handled correctly in the re module before Python 3.7. The behaviour in those earlier versions is:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">.split</span></code> won’t split a string at a zero-width match.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.sub</span></code> will advance by one character after a zero-width match.</p></li>
</ul>
</li>
<li><p>Inline flags apply to the entire pattern, and they can’t be turned off.</p></li>
<li><p>Only simple sets are supported.</p></li>
<li><p>Case-insensitive matches in Unicode use simple case-folding by default.</p></li>
</ul>
</li>
<li><p><strong>Version 1</strong> behaviour (new behaviour, possibly different from the re module):</p>
<ul class="simple">
<li><p>Indicated by the <code class="docutils literal notranslate"><span class="pre">VERSION1</span></code> or <code class="docutils literal notranslate"><span class="pre">V1</span></code> flag, or <code class="docutils literal notranslate"><span class="pre">(?V1)</span></code> in the pattern.</p></li>
<li><p>Zero-width matches are handled correctly.</p></li>
<li><p>Inline flags apply to the end of the group or pattern, and they can be turned off.</p></li>
<li><p>Nested sets and set operations are supported.</p></li>
<li><p>Case-insensitive matches in Unicode use full case-folding by default.</p></li>
</ul>
</li>
</ul>
<p>If no version is specified, the regex module will default to <code class="docutils literal notranslate"><span class="pre">regex.DEFAULT_VERSION</span></code>.</p>
</section>
<section id="case-insensitive-matches-in-unicode">
<h1>Case-insensitive matches in Unicode<a class="headerlink" href="#case-insensitive-matches-in-unicode" title="Permalink to this heading">¶</a></h1>
<p>The regex module supports both simple and full case-folding for case-insensitive matches in Unicode. Use of full case-folding can be turned on using the <code class="docutils literal notranslate"><span class="pre">FULLCASE</span></code> or <code class="docutils literal notranslate"><span class="pre">F</span></code> flag, or <code class="docutils literal notranslate"><span class="pre">(?f)</span></code> in the pattern. Please note that this flag affects how the <code class="docutils literal notranslate"><span class="pre">IGNORECASE</span></code> flag works; the <code class="docutils literal notranslate"><span class="pre">FULLCASE</span></code> flag itself does not turn on case-insensitive matching.</p>
<p>In the version 0 behaviour, the flag is off by default.</p>
<p>In the version 1 behaviour, the flag is on by default.</p>
</section>
<section id="nested-sets-and-set-operations">
<h1>Nested sets and set operations<a class="headerlink" href="#nested-sets-and-set-operations" title="Permalink to this heading">¶</a></h1>
<p>It’s not possible to support both simple sets, as used in the re module, and nested sets at the same time because of a difference in the meaning of an unescaped <code class="docutils literal notranslate"><span class="pre">&quot;[&quot;</span></code> in a set.</p>
<p>For example, the pattern <code class="docutils literal notranslate"><span class="pre">[[a-z]--[aeiou]]</span></code> is treated in the version 0 behaviour (simple sets, compatible with the re module) as:</p>
<ul class="simple">
<li><p>Set containing “[” and the letters “a” to “z”</p></li>
<li><p>Literal “–”</p></li>
<li><p>Set containing letters “a”, “e”, “i”, “o”, “u”</p></li>
<li><p>Literal “]”</p></li>
</ul>
<p>but in the version 1 behaviour (nested sets, enhanced behaviour) as:</p>
<ul class="simple">
<li><p>Set which is:</p>
<ul>
<li><p>Set containing the letters “a” to “z”</p></li>
</ul>
</li>
<li><p>but excluding:</p>
<ul>
<li><p>Set containing the letters “a”, “e”, “i”, “o”, “u”</p></li>
</ul>
</li>
</ul>
<p>Version 0 behaviour: only simple sets are supported.</p>
<p>Version 1 behaviour: nested sets and set operations are supported.</p>
</section>
<section id="flags">
<h1>Flags<a class="headerlink" href="#flags" title="Permalink to this heading">¶</a></h1>
<p>There are 2 kinds of flag: scoped and global. Scoped flags can apply to only part of a pattern and can be turned on or off; global flags apply to the entire pattern and can only be turned on.</p>
<p>The scoped flags are: <code class="docutils literal notranslate"><span class="pre">FULLCASE</span></code>, <code class="docutils literal notranslate"><span class="pre">IGNORECASE</span></code>, <code class="docutils literal notranslate"><span class="pre">MULTILINE</span></code>, <code class="docutils literal notranslate"><span class="pre">DOTALL</span></code>, <code class="docutils literal notranslate"><span class="pre">VERBOSE</span></code>, <code class="docutils literal notranslate"><span class="pre">WORD</span></code>.</p>
<p>The global flags are: <code class="docutils literal notranslate"><span class="pre">ASCII</span></code>, <code class="docutils literal notranslate"><span class="pre">BESTMATCH</span></code>, <code class="docutils literal notranslate"><span class="pre">ENHANCEMATCH</span></code>, <code class="docutils literal notranslate"><span class="pre">LOCALE</span></code>, <code class="docutils literal notranslate"><span class="pre">POSIX</span></code>, <code class="docutils literal notranslate"><span class="pre">REVERSE</span></code>, <code class="docutils literal notranslate"><span class="pre">UNICODE</span></code>, <code class="docutils literal notranslate"><span class="pre">VERSION0</span></code>, <code class="docutils literal notranslate"><span class="pre">VERSION1</span></code>.</p>
<p>If neither the <code class="docutils literal notranslate"><span class="pre">ASCII</span></code>, <code class="docutils literal notranslate"><span class="pre">LOCALE</span></code> nor <code class="docutils literal notranslate"><span class="pre">UNICODE</span></code> flag is specified, it will default to <code class="docutils literal notranslate"><span class="pre">UNICODE</span></code> if the regex pattern is a Unicode string and <code class="docutils literal notranslate"><span class="pre">ASCII</span></code> if it’s a bytestring.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ENHANCEMATCH</span></code> flag makes fuzzy matching attempt to improve the fit of the next match that it finds.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">BESTMATCH</span></code> flag makes fuzzy matching search for the best match instead of the next match.</p>
</section>
<section id="notes-on-named-capture-groups">
<h1>Notes on named capture groups<a class="headerlink" href="#notes-on-named-capture-groups" title="Permalink to this heading">¶</a></h1>
<p>All capture groups have a group number, starting from 1.</p>
<p>Groups with the same group name will have the same group number, and groups with a different group name will have a different group number.</p>
<p>The same name can be used by more than one group, with later captures ‘overwriting’ earlier captures. All of the captures of the group will be available from the <code class="docutils literal notranslate"><span class="pre">captures</span></code> method of the match object.</p>
<p>Group numbers will be reused across different branches of a branch reset, eg. <code class="docutils literal notranslate"><span class="pre">(?|(first)|(second))</span></code> has only group 1. If capture groups have different group names then they will, of course, have different group numbers, eg. <code class="docutils literal notranslate"><span class="pre">(?|(?P&lt;foo&gt;first)|(?P&lt;bar&gt;second))</span></code> has group 1 (“foo”) and group 2 (“bar”).</p>
<p>In the regex <code class="docutils literal notranslate"><span class="pre">(\s+)(?|(?P&lt;foo&gt;[A-Z]+)|(\w+)</span> <span class="pre">(?P&lt;foo&gt;[0-9]+)</span></code> there are 2 groups:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(\s+)</span></code> is group 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(?P&lt;foo&gt;[A-Z]+)</span></code> is group 2, also called “foo”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(\w+)</span></code> is group 2 because of the branch reset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(?P&lt;foo&gt;[0-9]+)</span></code> is group 2 because it’s called “foo”.</p></li>
</ul>
<p>If you want to prevent <code class="docutils literal notranslate"><span class="pre">(\w+)</span></code> from being group 2, you need to name it (different name, different group number).</p>
</section>
<section id="multithreading">
<h1>Multithreading<a class="headerlink" href="#multithreading" title="Permalink to this heading">¶</a></h1>
<p>The regex module releases the GIL during matching on instances of the built-in (immutable) string classes, enabling other Python threads to run concurrently. It is also possible to force the regex module to release the GIL during matching by calling the matching methods with the keyword argument <code class="docutils literal notranslate"><span class="pre">concurrent=True</span></code>. The behaviour is undefined if the string changes during matching, so use it <em>only</em> when it is guaranteed that that won’t happen.</p>
</section>
<section id="unicode">
<h1>Unicode<a class="headerlink" href="#unicode" title="Permalink to this heading">¶</a></h1>
<p>This module supports Unicode 13.0.0.</p>
<p>Full Unicode case-folding is supported.</p>
</section>
<section id="additional-features">
<h1>Additional features<a class="headerlink" href="#additional-features" title="Permalink to this heading">¶</a></h1>
<p>The issue numbers relate to the Python bug tracker, except where listed as “Hg issue”.</p>
<section id="added-support-for-lookaround-in-conditional-pattern-hg-issue-163">
<h2>Added support for lookaround in conditional pattern (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/163">Hg issue 163</a>)<a class="headerlink" href="#added-support-for-lookaround-in-conditional-pattern-hg-issue-163" title="Permalink to this heading">¶</a></h2>
<p>The test of a conditional pattern can now be a lookaround.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?(?=\d)\d+|\w+)&#39;</span><span class="p">,</span> <span class="s1">&#39;123abc&#39;</span><span class="p">)</span>
<span class="go">&lt;regex.Match object; span=(0, 3), match=&#39;123&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?(?=\d)\d+|\w+)&#39;</span><span class="p">,</span> <span class="s1">&#39;abc123&#39;</span><span class="p">)</span>
<span class="go">&lt;regex.Match object; span=(0, 6), match=&#39;abc123&#39;&gt;</span>
</pre></div>
</div>
<p>This is not quite the same as putting a lookaround in the first branch of a pair of alternatives.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?:(?=\d)\d+\b|\w+)&#39;</span><span class="p">,</span> <span class="s1">&#39;123abc&#39;</span><span class="p">))</span>
<span class="go">&lt;regex.Match object; span=(0, 6), match=&#39;123abc&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?(?=\d)\d+\b|\w+)&#39;</span><span class="p">,</span> <span class="s1">&#39;123abc&#39;</span><span class="p">))</span>
<span class="go">None</span>
</pre></div>
</div>
<p>In the first example, the lookaround matched, but the remainder of the first branch failed to match, and so the second branch was attempted, whereas in the second example, the lookaround matched, and the first branch failed to match, but the second branch was <strong>not</strong> attempted.</p>
</section>
<section id="added-posix-matching-leftmost-longest-hg-issue-150">
<h2>Added POSIX matching (leftmost longest) (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/150">Hg issue 150</a>)<a class="headerlink" href="#added-posix-matching-leftmost-longest-hg-issue-150" title="Permalink to this heading">¶</a></h2>
<p>The POSIX standard for regex is to return the leftmost longest match. This can be turned on using the <code class="docutils literal notranslate"><span class="pre">POSIX</span></code> flag (<code class="docutils literal notranslate"><span class="pre">(?p)</span></code>).</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Normal matching.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Mr|Mrs&#39;</span><span class="p">,</span> <span class="s1">&#39;Mrs&#39;</span><span class="p">)</span>
<span class="go">&lt;regex.Match object; span=(0, 2), match=&#39;Mr&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;one(self)?(selfsufficient)?&#39;</span><span class="p">,</span> <span class="s1">&#39;oneselfsufficient&#39;</span><span class="p">)</span>
<span class="go">&lt;regex.Match object; span=(0, 7), match=&#39;oneself&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># POSIX matching.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?p)Mr|Mrs&#39;</span><span class="p">,</span> <span class="s1">&#39;Mrs&#39;</span><span class="p">)</span>
<span class="go">&lt;regex.Match object; span=(0, 3), match=&#39;Mrs&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?p)one(self)?(selfsufficient)?&#39;</span><span class="p">,</span> <span class="s1">&#39;oneselfsufficient&#39;</span><span class="p">)</span>
<span class="go">&lt;regex.Match object; span=(0, 17), match=&#39;oneselfsufficient&#39;&gt;</span>
</pre></div>
</div>
<p>Note that it will take longer to find matches because when it finds a match at a certain position, it won’t return that immediately, but will keep looking to see if there’s another longer match there.</p>
</section>
<section id="added-define-hg-issue-152">
<h2>Added <code class="docutils literal notranslate"><span class="pre">(?(DEFINE)...)</span></code> (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/152">Hg issue 152</a>)<a class="headerlink" href="#added-define-hg-issue-152" title="Permalink to this heading">¶</a></h2>
<p>If there’s no group called “DEFINE”, then … will be ignored, but any group definitions within it will be available.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?(DEFINE)(?P&lt;quant&gt;\d+)(?P&lt;item&gt;\w+))(?&amp;quant) (?&amp;item)&#39;</span><span class="p">,</span> <span class="s1">&#39;5 elephants&#39;</span><span class="p">)</span>
<span class="go">&lt;regex.Match object; span=(0, 11), match=&#39;5 elephants&#39;&gt;</span>
</pre></div>
</div>
</section>
<section id="added-prune-skip-and-fail-hg-issue-153">
<h2>Added <code class="docutils literal notranslate"><span class="pre">(*PRUNE)</span></code>, <code class="docutils literal notranslate"><span class="pre">(*SKIP)</span></code> and <code class="docutils literal notranslate"><span class="pre">(*FAIL)</span></code> (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/153">Hg issue 153</a>)<a class="headerlink" href="#added-prune-skip-and-fail-hg-issue-153" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">(*PRUNE)</span></code> discards the backtracking info up to that point. When used in an atomic group or a lookaround, it won’t affect the enclosing pattern.</p>
<p><code class="docutils literal notranslate"><span class="pre">(*SKIP)</span></code> is similar to <code class="docutils literal notranslate"><span class="pre">(*PRUNE)</span></code>, except that it also sets where in the text the next attempt to match will start. When used in an atomic group or a lookaround, it won’t affect the enclosing pattern.</p>
<p><code class="docutils literal notranslate"><span class="pre">(*FAIL)</span></code> causes immediate backtracking. <code class="docutils literal notranslate"><span class="pre">(*F)</span></code> is a permitted abbreviation.</p>
</section>
<section id="added-k-hg-issue-151">
<h2>Added <code class="docutils literal notranslate"><span class="pre">\K</span></code> (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/151">Hg issue 151</a>)<a class="headerlink" href="#added-k-hg-issue-151" title="Permalink to this heading">¶</a></h2>
<p>Keeps the part of the entire match after the position where <code class="docutils literal notranslate"><span class="pre">\K</span></code> occurred; the part before it is discarded.</p>
<p>It does not affect what capture groups return.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\w\w\K\w\w\w)&#39;</span><span class="p">,</span> <span class="s1">&#39;abcdef&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&#39;cde&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&#39;abcde&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?r)(\w\w\K\w\w\w)&#39;</span><span class="p">,</span> <span class="s1">&#39;abcdef&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&#39;bc&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&#39;bcdef&#39;</span>
</pre></div>
</div>
</section>
<section id="added-capture-subscripting-for-expandf-and-subf-subfn-hg-issue-133">
<h2>Added capture subscripting for <code class="docutils literal notranslate"><span class="pre">expandf</span></code> and <code class="docutils literal notranslate"><span class="pre">subf</span></code>/<code class="docutils literal notranslate"><span class="pre">subfn</span></code> (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/133">Hg issue 133</a>)<a class="headerlink" href="#added-capture-subscripting-for-expandf-and-subf-subfn-hg-issue-133" title="Permalink to this heading">¶</a></h2>
<p>You can now use subscripting to get the captures of a repeated capture group.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\w)+&quot;</span><span class="p">,</span> <span class="s2">&quot;abc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">expandf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&#39;c&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">expandf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{1[0]}</span><span class="s2"> </span><span class="si">{1[1]}</span><span class="s2"> </span><span class="si">{1[2]}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&#39;a b c&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">expandf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{1[-1]}</span><span class="s2"> </span><span class="si">{1[-2]}</span><span class="s2"> </span><span class="si">{1[-3]}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&#39;c b a&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?P&lt;letter&gt;\w)+&quot;</span><span class="p">,</span> <span class="s2">&quot;abc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">expandf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{letter}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&#39;c&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">expandf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{letter[0]}</span><span class="s2"> </span><span class="si">{letter[1]}</span><span class="s2"> </span><span class="si">{letter[2]}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&#39;a b c&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">expandf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{letter[-1]}</span><span class="s2"> </span><span class="si">{letter[-2]}</span><span class="s2"> </span><span class="si">{letter[-3]}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&#39;c b a&#39;</span>
</pre></div>
</div>
</section>
<section id="added-support-for-referring-to-a-group-by-number-using-p">
<h2>Added support for referring to a group by number using <code class="docutils literal notranslate"><span class="pre">(?P=...)</span></code>.<a class="headerlink" href="#added-support-for-referring-to-a-group-by-number-using-p" title="Permalink to this heading">¶</a></h2>
<p>This is in addition to the existing <code class="docutils literal notranslate"><span class="pre">\g&lt;...&gt;</span></code>.</p>
</section>
<section id="fixed-the-handling-of-locale-sensitive-regexes">
<h2>Fixed the handling of locale-sensitive regexes.<a class="headerlink" href="#fixed-the-handling-of-locale-sensitive-regexes" title="Permalink to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">LOCALE</span></code> flag is intended for legacy code and has limited support. You’re still recommended to use Unicode instead.</p>
</section>
<section id="added-partial-matches-hg-issue-102">
<h2>Added partial matches (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/102">Hg issue 102</a>)<a class="headerlink" href="#added-partial-matches-hg-issue-102" title="Permalink to this heading">¶</a></h2>
<p>A partial match is one that matches up to the end of string, but that string has been truncated and you want to know whether a complete match could be possible if the string had not been truncated.</p>
<p>Partial matches are supported by <code class="docutils literal notranslate"><span class="pre">match</span></code>, <code class="docutils literal notranslate"><span class="pre">search</span></code>, <code class="docutils literal notranslate"><span class="pre">fullmatch</span></code> and <code class="docutils literal notranslate"><span class="pre">finditer</span></code> with the <code class="docutils literal notranslate"><span class="pre">partial</span></code> keyword argument.</p>
<p>Match objects have a <code class="docutils literal notranslate"><span class="pre">partial</span></code> attribute, which is <code class="docutils literal notranslate"><span class="pre">True</span></code> if it’s a partial match.</p>
<p>For example, if you wanted a user to enter a 4-digit number and check it character by character as it was being entered:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pattern</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d</span><span class="si">{4}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Initially, nothing has been entered:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">&lt;regex.Match object; span=(0, 0), match=&#39;&#39;, partial=True&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># An empty string is OK, but it&#39;s only a partial match.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The user enters a letter:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># It&#39;ll never match.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The user deletes that and enters a digit:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">&lt;regex.Match object; span=(0, 1), match=&#39;1&#39;, partial=True&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># It matches this far, but it&#39;s only a partial match.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The user enters 2 more digits:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">&lt;regex.Match object; span=(0, 3), match=&#39;123&#39;, partial=True&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># It matches this far, but it&#39;s only a partial match.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The user enters another digit:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="s1">&#39;1234&#39;</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">&lt;regex.Match object; span=(0, 4), match=&#39;1234&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># It&#39;s a complete match.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># If the user enters another digit:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="s1">&#39;12345&#39;</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># It&#39;s no longer a match.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This is a partial match:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">partial</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This is a complete match:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;1233&#39;</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">partial</span>
<span class="go">False</span>
</pre></div>
</div>
</section>
<section id="operator-not-working-correctly-with-sub-hg-issue-106">
<h2><code class="docutils literal notranslate"><span class="pre">*</span></code> operator not working correctly with sub() (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/106">Hg issue 106</a>)<a class="headerlink" href="#operator-not-working-correctly-with-sub-hg-issue-106" title="Permalink to this heading">¶</a></h2>
<p>Sometimes it’s not clear how zero-width matches should be handled. For example, should <code class="docutils literal notranslate"><span class="pre">.*</span></code> match 0 characters directly after matching &gt;0 characters?</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Python 3.7 and later</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">regex</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;.*&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="s1">&#39;xx&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">regex</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;.*?&#39;</span><span class="p">,</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="s1">&#39;|||||||||&#39;</span>

<span class="c1"># Python 3.6 and earlier</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">regex</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;(?V0).*&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="s1">&#39;x&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">regex</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;(?V1).*&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="s1">&#39;xx&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">regex</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;(?V0).*?&#39;</span><span class="p">,</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="s1">&#39;|t|e|s|t|&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">regex</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;(?V1).*?&#39;</span><span class="p">,</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="s1">&#39;|||||||||&#39;</span>
</pre></div>
</div>
</section>
<section id="added-capturesdict-hg-issue-86">
<h2>Added <code class="docutils literal notranslate"><span class="pre">capturesdict</span></code> (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/86">Hg issue 86</a>)<a class="headerlink" href="#added-capturesdict-hg-issue-86" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">capturesdict</span></code> is a combination of <code class="docutils literal notranslate"><span class="pre">groupdict</span></code> and <code class="docutils literal notranslate"><span class="pre">captures</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">groupdict</span></code> returns a dict of the named groups and the last capture of those groups.</p>
<p><code class="docutils literal notranslate"><span class="pre">captures</span></code> returns a list of all the captures of a group</p>
<p><code class="docutils literal notranslate"><span class="pre">capturesdict</span></code> returns a dict of the named groups and lists of all the captures of those groups.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:(?P&lt;word&gt;\w+) (?P&lt;digits&gt;\d+)\n)+&quot;</span><span class="p">,</span> <span class="s2">&quot;one 1</span><span class="se">\n</span><span class="s2">two 2</span><span class="se">\n</span><span class="s2">three 3</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span>
<span class="go">{&#39;word&#39;: &#39;three&#39;, &#39;digits&#39;: &#39;3&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">captures</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">)</span>
<span class="go">[&#39;one&#39;, &#39;two&#39;, &#39;three&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">captures</span><span class="p">(</span><span class="s2">&quot;digits&quot;</span><span class="p">)</span>
<span class="go">[&#39;1&#39;, &#39;2&#39;, &#39;3&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">capturesdict</span><span class="p">()</span>
<span class="go">{&#39;word&#39;: [&#39;one&#39;, &#39;two&#39;, &#39;three&#39;], &#39;digits&#39;: [&#39;1&#39;, &#39;2&#39;, &#39;3&#39;]}</span>
</pre></div>
</div>
</section>
<section id="allow-duplicate-names-of-groups-hg-issue-87">
<h2>Allow duplicate names of groups (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/87">Hg issue 87</a>)<a class="headerlink" href="#allow-duplicate-names-of-groups-hg-issue-87" title="Permalink to this heading">¶</a></h2>
<p>Group names can now be duplicated.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># With optional groups:</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Both groups capture, the second capture &#39;overwriting&#39; the first.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?P&lt;item&gt;\w+)? or (?P&lt;item&gt;\w+)?&quot;</span><span class="p">,</span> <span class="s2">&quot;first or second&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="go">&#39;second&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">captures</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="go">[&#39;first&#39;, &#39;second&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Only the second group captures.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?P&lt;item&gt;\w+)? or (?P&lt;item&gt;\w+)?&quot;</span><span class="p">,</span> <span class="s2">&quot; or second&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="go">&#39;second&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">captures</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="go">[&#39;second&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Only the first group captures.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?P&lt;item&gt;\w+)? or (?P&lt;item&gt;\w+)?&quot;</span><span class="p">,</span> <span class="s2">&quot;first or &quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="go">&#39;first&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">captures</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="go">[&#39;first&#39;]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># With mandatory groups:</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Both groups capture, the second capture &#39;overwriting&#39; the first.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?P&lt;item&gt;\w*) or (?P&lt;item&gt;\w*)?&quot;</span><span class="p">,</span> <span class="s2">&quot;first or second&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="go">&#39;second&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">captures</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="go">[&#39;first&#39;, &#39;second&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Again, both groups capture, the second capture &#39;overwriting&#39; the first.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?P&lt;item&gt;\w*) or (?P&lt;item&gt;\w*)&quot;</span><span class="p">,</span> <span class="s2">&quot; or second&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="go">&#39;second&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">captures</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="go">[&#39;&#39;, &#39;second&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># And yet again, both groups capture, the second capture &#39;overwriting&#39; the first.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?P&lt;item&gt;\w*) or (?P&lt;item&gt;\w*)&quot;</span><span class="p">,</span> <span class="s2">&quot;first or &quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">captures</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<span class="go">[&#39;first&#39;, &#39;&#39;]</span>
</pre></div>
</div>
</section>
<section id="added-fullmatch-issue-16203">
<h2>Added <code class="docutils literal notranslate"><span class="pre">fullmatch</span></code> (<a class="reference external" href="https://bugs.python.org/issue16203">issue #16203</a>)<a class="headerlink" href="#added-fullmatch-issue-16203" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">fullmatch</span></code> behaves like <code class="docutils literal notranslate"><span class="pre">match</span></code>, except that it must match all of the string.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">regex</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="s2">&quot;abc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">span</span><span class="p">())</span>
<span class="go">(0, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">regex</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="s2">&quot;abcx&quot;</span><span class="p">))</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">regex</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="s2">&quot;abcx&quot;</span><span class="p">,</span> <span class="n">endpos</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">span</span><span class="p">())</span>
<span class="go">(0, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">regex</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="s2">&quot;xabcy&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">endpos</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">span</span><span class="p">())</span>
<span class="go">(1, 4)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;a.*?&quot;</span><span class="p">,</span> <span class="s2">&quot;abcd&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&#39;a&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;a.*?&quot;</span><span class="p">,</span> <span class="s2">&quot;abcd&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&#39;abcd&#39;</span>
</pre></div>
</div>
</section>
<section id="added-subf-and-subfn">
<h2>Added <code class="docutils literal notranslate"><span class="pre">subf</span></code> and <code class="docutils literal notranslate"><span class="pre">subfn</span></code><a class="headerlink" href="#added-subf-and-subfn" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">subf</span></code> and <code class="docutils literal notranslate"><span class="pre">subfn</span></code> are alternatives to <code class="docutils literal notranslate"><span class="pre">sub</span></code> and <code class="docutils literal notranslate"><span class="pre">subn</span></code> respectively. When passed a replacement string, they treat it as a format string.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">subf</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\w+) (\w+)&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> =&gt; </span><span class="si">{2}</span><span class="s2"> </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;foo bar&quot;</span><span class="p">)</span>
<span class="go">&#39;foo bar =&gt; bar foo&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">subf</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?P&lt;word1&gt;\w+) (?P&lt;word2&gt;\w+)&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{word2}</span><span class="s2"> </span><span class="si">{word1}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;foo bar&quot;</span><span class="p">)</span>
<span class="go">&#39;bar foo&#39;</span>
</pre></div>
</div>
</section>
<section id="added-expandf-to-match-object">
<h2>Added <code class="docutils literal notranslate"><span class="pre">expandf</span></code> to match object<a class="headerlink" href="#added-expandf-to-match-object" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">expandf</span></code> is an alternative to <code class="docutils literal notranslate"><span class="pre">expand</span></code>. When passed a replacement string, it treats it as a format string.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\w+) (\w+)&quot;</span><span class="p">,</span> <span class="s2">&quot;foo bar&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">expandf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> =&gt; </span><span class="si">{2}</span><span class="s2"> </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&#39;foo bar =&gt; bar foo&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?P&lt;word1&gt;\w+) (?P&lt;word2&gt;\w+)&quot;</span><span class="p">,</span> <span class="s2">&quot;foo bar&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">expandf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{word2}</span><span class="s2"> </span><span class="si">{word1}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&#39;bar foo&#39;</span>
</pre></div>
</div>
</section>
<section id="detach-searched-string">
<h2>Detach searched string<a class="headerlink" href="#detach-searched-string" title="Permalink to this heading">¶</a></h2>
<p>A match object contains a reference to the string that was searched, via its <code class="docutils literal notranslate"><span class="pre">string</span></code> attribute. The <code class="docutils literal notranslate"><span class="pre">detach_string</span></code> method will ‘detach’ that string, making it available for garbage collection, which might save valuable memory if that string is very large.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\w+&quot;</span><span class="p">,</span> <span class="s2">&quot;Hello world&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
<span class="go">Hello</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
<span class="go">Hello world</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">detach_string</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
<span class="go">Hello</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
<span class="go">None</span>
</pre></div>
</div>
</section>
<section id="recursive-patterns-hg-issue-27">
<h2>Recursive patterns (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/27">Hg issue 27</a>)<a class="headerlink" href="#recursive-patterns-hg-issue-27" title="Permalink to this heading">¶</a></h2>
<p>Recursive and repeated patterns are supported.</p>
<p><code class="docutils literal notranslate"><span class="pre">(?R)</span></code> or <code class="docutils literal notranslate"><span class="pre">(?0)</span></code> tries to match the entire regex recursively. <code class="docutils literal notranslate"><span class="pre">(?1)</span></code>, <code class="docutils literal notranslate"><span class="pre">(?2)</span></code>, etc, try to match the relevant capture group.</p>
<p><code class="docutils literal notranslate"><span class="pre">(?&amp;name)</span></code> tries to match the named capture group.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(Tarzan|Jane) loves (?1)&quot;</span><span class="p">,</span> <span class="s2">&quot;Tarzan loves Jane&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="go">(&#39;Tarzan&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(Tarzan|Jane) loves (?1)&quot;</span><span class="p">,</span> <span class="s2">&quot;Jane loves Tarzan&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="go">(&#39;Jane&#39;,)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\w)(?:(?R)|(\w?))\1&quot;</span><span class="p">,</span> <span class="s2">&quot;kayak&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">(&#39;kayak&#39;, &#39;k&#39;, None)</span>
</pre></div>
</div>
<p>The first two examples show how the subpattern within the capture group is reused, but is _not_ itself a capture group. In other words, <code class="docutils literal notranslate"><span class="pre">&quot;(Tarzan|Jane)</span> <span class="pre">loves</span> <span class="pre">(?1)&quot;</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">&quot;(Tarzan|Jane)</span> <span class="pre">loves</span> <span class="pre">(?:Tarzan|Jane)&quot;</span></code>.</p>
<p>It’s possible to backtrack into a recursed or repeated group.</p>
<p>You can’t call a group if there is more than one group with that group name or group number (<code class="docutils literal notranslate"><span class="pre">&quot;ambiguous</span> <span class="pre">group</span> <span class="pre">reference&quot;</span></code>).</p>
<p>The alternative forms <code class="docutils literal notranslate"><span class="pre">(?P&gt;name)</span></code> and <code class="docutils literal notranslate"><span class="pre">(?P&amp;name)</span></code> are also supported.</p>
</section>
<section id="full-unicode-case-folding-is-supported">
<h2>Full Unicode case-folding is supported.<a class="headerlink" href="#full-unicode-case-folding-is-supported" title="Permalink to this heading">¶</a></h2>
<p>In version 1 behaviour, the regex module uses full case-folding when performing case-insensitive matches in Unicode.</p>
<p>Examples (in Python 3):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?iV1)strasse&quot;</span><span class="p">,</span> <span class="s2">&quot;stra</span><span class="se">\N{LATIN SMALL LETTER SHARP S}</span><span class="s2">e&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">span</span><span class="p">()</span>
<span class="go">(0, 6)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?iV1)stra\N{LATIN SMALL LETTER SHARP S}e&quot;</span><span class="p">,</span> <span class="s2">&quot;STRASSE&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">span</span><span class="p">()</span>
<span class="go">(0, 7)</span>
</pre></div>
</div>
<p>In version 0 behaviour, it uses simple case-folding for backward compatibility with the re module.</p>
</section>
<section id="approximate-fuzzy-matching-hg-issue-12-hg-issue-41-hg-issue-109">
<h2>Approximate “fuzzy” matching (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/12">Hg issue 12</a>, <a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/41">Hg issue 41</a>, <a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/109">Hg issue 109</a>)<a class="headerlink" href="#approximate-fuzzy-matching-hg-issue-12-hg-issue-41-hg-issue-109" title="Permalink to this heading">¶</a></h2>
<p>Regex usually attempts an exact match, but sometimes an approximate, or “fuzzy”, match is needed, for those cases where the text being searched may contain errors in the form of inserted, deleted or substituted characters.</p>
<p>A fuzzy regex specifies which types of errors are permitted, and, optionally, either the minimum and maximum or only the maximum permitted number of each type. (You cannot specify only a minimum.)</p>
<p>The 3 types of error are:</p>
<ul class="simple">
<li><p>Insertion, indicated by “i”</p></li>
<li><p>Deletion, indicated by “d”</p></li>
<li><p>Substitution, indicated by “s”</p></li>
</ul>
<p>In addition, “e” indicates any type of error.</p>
<p>The fuzziness of a regex item is specified between “{” and “}” after the item.</p>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">foo</span></code> match “foo” exactly</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(?:foo){i}</span></code> match “foo”, permitting insertions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(?:foo){d}</span></code> match “foo”, permitting deletions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(?:foo){s}</span></code> match “foo”, permitting substitutions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(?:foo){i,s}</span></code> match “foo”, permitting insertions and substitutions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(?:foo){e}</span></code> match “foo”, permitting errors</p></li>
</ul>
<p>If a certain type of error is specified, then any type not specified will <strong>not</strong> be permitted.</p>
<p>In the following examples I’ll omit the item and write only the fuzziness:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{d&lt;=3}</span></code> permit at most 3 deletions, but no other types</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{i&lt;=1,s&lt;=2}</span></code> permit at most 1 insertion and at most 2 substitutions, but no deletions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{1&lt;=e&lt;=3}</span></code> permit at least 1 and at most 3 errors</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{i&lt;=2,d&lt;=2,e&lt;=3}</span></code> permit at most 2 insertions, at most 2 deletions, at most 3 errors in total, but no substitutions</p></li>
</ul>
<p>It’s also possible to state the costs of each type of error and the maximum permitted total cost.</p>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{2i+2d+1s&lt;=4}</span></code> each insertion costs 2, each deletion costs 2, each substitution costs 1, the total cost must not exceed 4</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{i&lt;=1,d&lt;=1,s&lt;=1,2i+2d+1s&lt;=4}</span></code> at most 1 insertion, at most 1 deletion, at most 1 substitution; each insertion costs 2, each deletion costs 2, each substitution costs 1, the total cost must not exceed 4</p></li>
</ul>
<p>You can also use “&lt;” instead of “&lt;=” if you want an exclusive minimum or maximum.</p>
<p>You can add a test to perform on a character that’s substituted or inserted.</p>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{s&lt;=2:[a-z]}</span></code> at most 2 substitutions, which must be in the character set <code class="docutils literal notranslate"><span class="pre">[a-z]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{s&lt;=2,i&lt;=3:\d}</span></code> at most 2 substitutions, at most 3 insertions, which must be digits.</p></li>
</ul>
<p>By default, fuzzy matching searches for the first match that meets the given constraints. The <code class="docutils literal notranslate"><span class="pre">ENHANCEMATCH</span></code> flag will cause it to attempt to improve the fit (i.e. reduce the number of errors) of the match that it has found.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">BESTMATCH</span></code> flag will make it search for the best match instead.</p>
<p>Further examples to note:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">regex.search(&quot;(dog){e}&quot;,</span> <span class="pre">&quot;cat</span> <span class="pre">and</span> <span class="pre">dog&quot;)[1]</span></code> returns <code class="docutils literal notranslate"><span class="pre">&quot;cat&quot;</span></code> because that matches <code class="docutils literal notranslate"><span class="pre">&quot;dog&quot;</span></code> with 3 errors (an unlimited number of errors is permitted).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">regex.search(&quot;(dog){e&lt;=1}&quot;,</span> <span class="pre">&quot;cat</span> <span class="pre">and</span> <span class="pre">dog&quot;)[1]</span></code> returns <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">dog&quot;</span></code> (with a leading space) because that matches <code class="docutils literal notranslate"><span class="pre">&quot;dog&quot;</span></code> with 1 error, which is within the limit.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">regex.search(&quot;(?e)(dog){e&lt;=1}&quot;,</span> <span class="pre">&quot;cat</span> <span class="pre">and</span> <span class="pre">dog&quot;)[1]</span></code> returns <code class="docutils literal notranslate"><span class="pre">&quot;dog&quot;</span></code> (without a leading space) because the fuzzy search matches <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">dog&quot;</span></code> with 1 error, which is within the limit, and the <code class="docutils literal notranslate"><span class="pre">(?e)</span></code> then it attempts a better fit.</p></li>
</ul>
<p>In the first two examples there are perfect matches later in the string, but in neither case is it the first possible match.</p>
<p>The match object has an attribute <code class="docutils literal notranslate"><span class="pre">fuzzy_counts</span></code> which gives the total number of substitutions, insertions and deletions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># A &#39;raw&#39; fuzzy match:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:cats|cat){e&lt;=1}&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fuzzy_counts</span>
<span class="go">(0, 0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 0 substitutions, 0 insertions, 1 deletion.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># A better match might be possible if the ENHANCEMATCH flag used:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?e)(?:cats|cat){e&lt;=1}&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fuzzy_counts</span>
<span class="go">(0, 0, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 0 substitutions, 0 insertions, 0 deletions.</span>
</pre></div>
</div>
<p>The match object also has an attribute <code class="docutils literal notranslate"><span class="pre">fuzzy_changes</span></code> which gives a tuple of the positions of the substitutions, insertions and deletions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;(fuu){i&lt;=2,d&lt;=2,e&lt;=5}&#39;</span><span class="p">,</span> <span class="s1">&#39;anaconda foo bar&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span>
<span class="go">&lt;regex.Match object; span=(7, 10), match=&#39;a f&#39;, fuzzy_counts=(0, 2, 2)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">fuzzy_changes</span>
<span class="go">([], [7, 8], [10, 11])</span>
</pre></div>
</div>
<p>What this means is that if the matched part of the string had been:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;anacondfuuoo bar&#39;</span>
</pre></div>
</div>
<p>it would’ve been an exact match.</p>
<p>However, there were insertions at positions 7 and 8:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;anaconda fuuoo bar&#39;</span>
        <span class="o">^^</span>
</pre></div>
</div>
<p>and deletions at positions 10 and 11:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;anaconda f~~oo bar&#39;</span>
           <span class="o">^^</span>
</pre></div>
</div>
<p>So the actual string was:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;anaconda foo bar&#39;</span>
</pre></div>
</div>
</section>
<section id="named-lists-hg-issue-11">
<h2>Named lists (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/11">Hg issue 11</a>)<a class="headerlink" href="#named-lists-hg-issue-11" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">\L&lt;name&gt;</span></code></p>
<p>There are occasions where you may want to include a list (actually, a set) of options in a regex.</p>
<p>One way is to build the pattern like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;first|second|third|fourth|fifth&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>but if the list is large, parsing the resulting regex can take considerable time, and care must also be taken that the strings are properly escaped and properly ordered, for example, “cats” before “cat”.</p>
<p>The new alternative is to use a named list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">option_set</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;second&quot;</span><span class="p">,</span> <span class="s2">&quot;third&quot;</span><span class="p">,</span> <span class="s2">&quot;fourth&quot;</span><span class="p">,</span> <span class="s2">&quot;fifth&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\L&lt;options&gt;&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">option_set</span><span class="p">)</span>
</pre></div>
</div>
<p>The order of the items is irrelevant, they are treated as a set. The named lists are available as the <code class="docutils literal notranslate"><span class="pre">.named_lists</span></code> attribute of the pattern object :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">named_lists</span><span class="p">)</span>
<span class="go"># Python 3</span>
<span class="go">{&#39;options&#39;: frozenset({&#39;fifth&#39;, &#39;first&#39;, &#39;fourth&#39;, &#39;second&#39;, &#39;third&#39;})}</span>
<span class="go"># Python 2</span>
<span class="go">{&#39;options&#39;: frozenset([&#39;fifth&#39;, &#39;fourth&#39;, &#39;second&#39;, &#39;third&#39;, &#39;first&#39;])}</span>
</pre></div>
</div>
<p>If there are any unused keyword arguments, <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> will be raised unless you tell it otherwise:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">option_set</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;second&quot;</span><span class="p">,</span> <span class="s2">&quot;third&quot;</span><span class="p">,</span> <span class="s2">&quot;fourth&quot;</span><span class="p">,</span> <span class="s2">&quot;fifth&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\L&lt;options&gt;&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">option_set</span><span class="p">,</span> <span class="n">other_options</span><span class="o">=</span><span class="p">[])</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;C:\Python37\lib\site-packages\regex\regex.py&quot;</span>, line <span class="m">348</span>, in <span class="n">compile</span>
    <span class="k">return</span> <span class="n">_compile</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">ignore_unused</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
  File <span class="nb">&quot;C:\Python37\lib\site-packages\regex\regex.py&quot;</span>, line <span class="m">585</span>, in <span class="n">_compile</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;unused keyword argument </span><span class="si">{!a}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">any_one</span><span class="p">))</span>
<span class="gr">ValueError</span>: <span class="n">unused keyword argument &#39;other_options&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\L&lt;options&gt;&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">option_set</span><span class="p">,</span> <span class="n">other_options</span><span class="o">=</span><span class="p">[],</span> <span class="n">ignore_unused</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</section>
<section id="start-and-end-of-word">
<h2>Start and end of word<a class="headerlink" href="#start-and-end-of-word" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">\m</span></code> matches at the start of a word.</p>
<p><code class="docutils literal notranslate"><span class="pre">\M</span></code> matches at the end of a word.</p>
<p>Compare with <code class="docutils literal notranslate"><span class="pre">\b</span></code>, which matches at the start or end of a word.</p>
</section>
<section id="unicode-line-separators">
<h2>Unicode line separators<a class="headerlink" href="#unicode-line-separators" title="Permalink to this heading">¶</a></h2>
<p>Normally the only line separator is <code class="docutils literal notranslate"><span class="pre">\n</span></code> (<code class="docutils literal notranslate"><span class="pre">\x0A</span></code>), but if the <code class="docutils literal notranslate"><span class="pre">WORD</span></code> flag is turned on then the line separators are <code class="docutils literal notranslate"><span class="pre">\x0D\x0A</span></code>, <code class="docutils literal notranslate"><span class="pre">\x0A</span></code>, <code class="docutils literal notranslate"><span class="pre">\x0B</span></code>, <code class="docutils literal notranslate"><span class="pre">\x0C</span></code> and <code class="docutils literal notranslate"><span class="pre">\x0D</span></code>, plus <code class="docutils literal notranslate"><span class="pre">\x85</span></code>, <code class="docutils literal notranslate"><span class="pre">\u2028</span></code> and <code class="docutils literal notranslate"><span class="pre">\u2029</span></code> when working with Unicode.</p>
<p>This affects the regex dot <code class="docutils literal notranslate"><span class="pre">&quot;.&quot;</span></code>, which, with the <code class="docutils literal notranslate"><span class="pre">DOTALL</span></code> flag turned off, matches any character except a line separator. It also affects the line anchors <code class="docutils literal notranslate"><span class="pre">^</span></code> and <code class="docutils literal notranslate"><span class="pre">$</span></code> (in multiline mode).</p>
</section>
<section id="set-operators">
<h2>Set operators<a class="headerlink" href="#set-operators" title="Permalink to this heading">¶</a></h2>
<p><strong>Version 1 behaviour only</strong></p>
<p>Set operators have been added, and a set <code class="docutils literal notranslate"><span class="pre">[...]</span></code> can include nested sets.</p>
<p>The operators, in order of increasing precedence, are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">||</span></code> for union (“x||y” means “x or y”)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">~~</span></code> (double tilde) for symmetric difference (“x~~y” means “x or y, but not both”)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> for intersection (“x&amp;&amp;y” means “x and y”)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--</span></code> (double dash) for difference (“x–y” means “x but not y”)</p></li>
</ul>
<p>Implicit union, ie, simple juxtaposition like in <code class="docutils literal notranslate"><span class="pre">[ab]</span></code>, has the highest precedence. Thus, <code class="docutils literal notranslate"><span class="pre">[ab&amp;&amp;cd]</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">[[a||b]&amp;&amp;[c||d]]</span></code>.</p>
<p>Examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[ab]</span></code> # Set containing ‘a’ and ‘b’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[a-z]</span></code> # Set containing ‘a’ .. ‘z’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[[a-z]--[qw]]</span></code> # Set containing ‘a’ .. ‘z’, but not ‘q’ or ‘w’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[a-z--qw]</span></code> # Same as above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[\p{L}--QW]</span></code> # Set containing all letters except ‘Q’ and ‘W’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[\p{N}--[0-9]]</span></code> # Set containing all numbers except ‘0’ .. ‘9’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[\p{ASCII}&amp;&amp;\p{Letter}]</span></code> # Set containing all characters which are ASCII and letter</p></li>
</ul>
</section>
<section id="regex-escape-issue-2650">
<h2>regex.escape (<a class="reference external" href="https://bugs.python.org/issue2650">issue #2650</a>)<a class="headerlink" href="#regex-escape-issue-2650" title="Permalink to this heading">¶</a></h2>
<p>regex.escape has an additional keyword parameter <code class="docutils literal notranslate"><span class="pre">special_only</span></code>. When True, only ‘special’ regex characters, such as ‘?’, are escaped.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="s2">&quot;foo!?&quot;</span><span class="p">,</span> <span class="n">special_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&#39;foo\\!\\?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="s2">&quot;foo!?&quot;</span><span class="p">,</span> <span class="n">special_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;foo!\\?&#39;</span>
</pre></div>
</div>
</section>
<section id="regex-escape-hg-issue-249">
<h2>regex.escape (<a class="reference external" href="https://bitbucket.org/mrabarnett/mrab-regex/issues/249">Hg issue 249</a>)<a class="headerlink" href="#regex-escape-hg-issue-249" title="Permalink to this heading">¶</a></h2>
<p>regex.escape has an additional keyword parameter <code class="docutils literal notranslate"><span class="pre">literal_spaces</span></code>. When True, spaces are not escaped.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="s2">&quot;foo bar!?&quot;</span><span class="p">,</span> <span class="n">literal_spaces</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&#39;foo\\ bar!\\?&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="s2">&quot;foo bar!?&quot;</span><span class="p">,</span> <span class="n">literal_spaces</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;foo bar!\\?&#39;</span>
</pre></div>
</div>
</section>
<section id="repeated-captures-issue-7132">
<h2>Repeated captures (<a class="reference external" href="https://bugs.python.org/issue7132">issue #7132</a>)<a class="headerlink" href="#repeated-captures-issue-7132" title="Permalink to this heading">¶</a></h2>
<p>A match object has additional methods which return information on all the successful matches of a repeated capture group. These methods are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">matchobject.captures([group1,</span> <span class="pre">...])</span></code></p>
<ul>
<li><p>Returns a list of the strings matched in a group or groups. Compare with <code class="docutils literal notranslate"><span class="pre">matchobject.group([group1,</span> <span class="pre">...])</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">matchobject.starts([group])</span></code></p>
<ul>
<li><p>Returns a list of the start positions. Compare with <code class="docutils literal notranslate"><span class="pre">matchobject.start([group])</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">matchobject.ends([group])</span></code></p>
<ul>
<li><p>Returns a list of the end positions. Compare with <code class="docutils literal notranslate"><span class="pre">matchobject.end([group])</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">matchobject.spans([group])</span></code></p>
<ul>
<li><p>Returns a list of the spans. Compare with <code class="docutils literal notranslate"><span class="pre">matchobject.span([group])</span></code>.</p></li>
</ul>
</li>
</ul>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\w</span><span class="si">{3}</span><span class="s2">)+&quot;</span><span class="p">,</span> <span class="s2">&quot;123456789&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;789&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">captures</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[&#39;123&#39;, &#39;456&#39;, &#39;789&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">starts</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[0, 3, 6]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">ends</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[3, 6, 9]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">span</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(6, 9)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">spans</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[(0, 3), (3, 6), (6, 9)]</span>
</pre></div>
</div>
</section>
<section id="atomic-grouping-issue-433030">
<h2>Atomic grouping (<a class="reference external" href="https://bugs.python.org/issue433030">issue #433030</a>)<a class="headerlink" href="#atomic-grouping-issue-433030" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">(?&gt;...)</span></code></p>
<p>If the following pattern subsequently fails, then the subpattern as a whole will fail.</p>
</section>
<section id="possessive-quantifiers">
<h2>Possessive quantifiers.<a class="headerlink" href="#possessive-quantifiers" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">(?:...)?+</span></code> ; <code class="docutils literal notranslate"><span class="pre">(?:...)*+</span></code> ; <code class="docutils literal notranslate"><span class="pre">(?:...)++</span></code> ; <code class="docutils literal notranslate"><span class="pre">(?:...){min,max}+</span></code></p>
<p>The subpattern is matched up to ‘max’ times. If the following pattern subsequently fails, then all of the repeated subpatterns will fail as a whole. For example, <code class="docutils literal notranslate"><span class="pre">(?:...)++</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">(?&gt;(?:...)+)</span></code>.</p>
</section>
<section id="scoped-flags-issue-433028">
<h2>Scoped flags (<a class="reference external" href="https://bugs.python.org/issue433028">issue #433028</a>)<a class="headerlink" href="#scoped-flags-issue-433028" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">(?flags-flags:...)</span></code></p>
<p>The flags will apply only to the subpattern. Flags can be turned on or off.</p>
</section>
<section id="definition-of-word-character-issue-1693050">
<h2>Definition of ‘word’ character (<a class="reference external" href="https://bugs.python.org/issue1693050">issue #1693050</a>)<a class="headerlink" href="#definition-of-word-character-issue-1693050" title="Permalink to this heading">¶</a></h2>
<p>The definition of a ‘word’ character has been expanded for Unicode. It now conforms to the Unicode specification at <code class="docutils literal notranslate"><span class="pre">http://www.unicode.org/reports/tr29/</span></code>.</p>
</section>
<section id="variable-length-lookbehind">
<h2>Variable-length lookbehind<a class="headerlink" href="#variable-length-lookbehind" title="Permalink to this heading">¶</a></h2>
<p>A lookbehind can match a variable-length string.</p>
</section>
<section id="flags-argument-for-regex-split-regex-sub-and-regex-subn-issue-3482">
<h2>Flags argument for regex.split, regex.sub and regex.subn (<a class="reference external" href="https://bugs.python.org/issue3482">issue #3482</a>)<a class="headerlink" href="#flags-argument-for-regex-split-regex-sub-and-regex-subn-issue-3482" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">regex.split</span></code>, <code class="docutils literal notranslate"><span class="pre">regex.sub</span></code> and <code class="docutils literal notranslate"><span class="pre">regex.subn</span></code> support a ‘flags’ argument.</p>
</section>
<section id="pos-and-endpos-arguments-for-regex-sub-and-regex-subn">
<h2>Pos and endpos arguments for regex.sub and regex.subn<a class="headerlink" href="#pos-and-endpos-arguments-for-regex-sub-and-regex-subn" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">regex.sub</span></code> and <code class="docutils literal notranslate"><span class="pre">regex.subn</span></code> support ‘pos’ and ‘endpos’ arguments.</p>
</section>
<section id="overlapped-argument-for-regex-findall-and-regex-finditer">
<h2>‘Overlapped’ argument for regex.findall and regex.finditer<a class="headerlink" href="#overlapped-argument-for-regex-findall-and-regex-finditer" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">regex.findall</span></code> and <code class="docutils literal notranslate"><span class="pre">regex.finditer</span></code> support an ‘overlapped’ flag which permits overlapped matches.</p>
</section>
<section id="splititer">
<h2>Splititer<a class="headerlink" href="#splititer" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">regex.splititer</span></code> has been added. It’s a generator equivalent of <code class="docutils literal notranslate"><span class="pre">regex.split</span></code>.</p>
</section>
<section id="subscripting-for-groups">
<h2>Subscripting for groups<a class="headerlink" href="#subscripting-for-groups" title="Permalink to this heading">¶</a></h2>
<p>A match object accepts access to the captured groups via subscripting and slicing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?P&lt;before&gt;.*?)(?P&lt;num&gt;\d+)(?P&lt;after&gt;.*)&quot;</span><span class="p">,</span> <span class="s2">&quot;pqr123stu&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s2">&quot;before&quot;</span><span class="p">])</span>
<span class="go">pqr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">[:])</span>
<span class="go">(&#39;pqr123stu&#39;, &#39;pqr&#39;, &#39;123&#39;, &#39;stu&#39;)</span>
</pre></div>
</div>
</section>
<section id="named-groups">
<h2>Named groups<a class="headerlink" href="#named-groups" title="Permalink to this heading">¶</a></h2>
<p>Groups can be named with <code class="docutils literal notranslate"><span class="pre">(?&lt;name&gt;...)</span></code> as well as the current <code class="docutils literal notranslate"><span class="pre">(?P&lt;name&gt;...)</span></code>.</p>
</section>
<section id="group-references">
<h2>Group references<a class="headerlink" href="#group-references" title="Permalink to this heading">¶</a></h2>
<p>Groups can be referenced within a pattern with <code class="docutils literal notranslate"><span class="pre">\g&lt;name&gt;</span></code>. This also allows there to be more than 99 groups.</p>
</section>
<section id="named-characters">
<h2>Named characters<a class="headerlink" href="#named-characters" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">\N{name}</span></code></p>
<p>Named characters are supported. (Note: only those known by Python’s Unicode database are supported.)</p>
</section>
<section id="unicode-codepoint-properties-including-scripts-and-blocks">
<h2>Unicode codepoint properties, including scripts and blocks<a class="headerlink" href="#unicode-codepoint-properties-including-scripts-and-blocks" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">\p{property=value}</span></code>; <code class="docutils literal notranslate"><span class="pre">\P{property=value}</span></code>; <code class="docutils literal notranslate"><span class="pre">\p{value}</span></code> ; <code class="docutils literal notranslate"><span class="pre">\P{value}</span></code></p>
<p>Many Unicode properties are supported, including blocks and scripts. <code class="docutils literal notranslate"><span class="pre">\p{property=value}</span></code> or <code class="docutils literal notranslate"><span class="pre">\p{property:value}</span></code> matches a character whose property <code class="docutils literal notranslate"><span class="pre">property</span></code> has value <code class="docutils literal notranslate"><span class="pre">value</span></code>. The inverse of <code class="docutils literal notranslate"><span class="pre">\p{property=value}</span></code> is <code class="docutils literal notranslate"><span class="pre">\P{property=value}</span></code> or <code class="docutils literal notranslate"><span class="pre">\p{^property=value}</span></code>.</p>
<p>If the short form <code class="docutils literal notranslate"><span class="pre">\p{value}</span></code> is used, the properties are checked in the order: <code class="docutils literal notranslate"><span class="pre">General_Category</span></code>, <code class="docutils literal notranslate"><span class="pre">Script</span></code>, <code class="docutils literal notranslate"><span class="pre">Block</span></code>, binary property:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Latin</span></code>, the ‘Latin’ script (<code class="docutils literal notranslate"><span class="pre">Script=Latin</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BasicLatin</span></code>, the ‘BasicLatin’ block (<code class="docutils literal notranslate"><span class="pre">Block=BasicLatin</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Alphabetic</span></code>, the ‘Alphabetic’ binary property (<code class="docutils literal notranslate"><span class="pre">Alphabetic=Yes</span></code>).</p></li>
</ul>
<p>A short form starting with <code class="docutils literal notranslate"><span class="pre">Is</span></code> indicates a script or binary property:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">IsLatin</span></code>, the ‘Latin’ script (<code class="docutils literal notranslate"><span class="pre">Script=Latin</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IsAlphabetic</span></code>, the ‘Alphabetic’ binary property (<code class="docutils literal notranslate"><span class="pre">Alphabetic=Yes</span></code>).</p></li>
</ul>
<p>A short form starting with <code class="docutils literal notranslate"><span class="pre">In</span></code> indicates a block property:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">InBasicLatin</span></code>, the ‘BasicLatin’ block (<code class="docutils literal notranslate"><span class="pre">Block=BasicLatin</span></code>).</p></li>
</ul>
</section>
<section id="posix-character-classes">
<h2>POSIX character classes<a class="headerlink" href="#posix-character-classes" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">[[:alpha:]]</span></code>; <code class="docutils literal notranslate"><span class="pre">[[:^alpha:]]</span></code></p>
<p>POSIX character classes are supported. These are normally treated as an alternative form of <code class="docutils literal notranslate"><span class="pre">\p{...}</span></code>.</p>
<p>The exceptions are <code class="docutils literal notranslate"><span class="pre">alnum</span></code>, <code class="docutils literal notranslate"><span class="pre">digit</span></code>, <code class="docutils literal notranslate"><span class="pre">punct</span></code> and <code class="docutils literal notranslate"><span class="pre">xdigit</span></code>, whose definitions are different from those of Unicode.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[:alnum:]]</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">\p{posix_alnum}</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[:digit:]]</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">\p{posix_digit}</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[:punct:]]</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">\p{posix_punct}</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">[[:xdigit:]]</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">\p{posix_xdigit}</span></code>.</p>
</section>
<section id="search-anchor">
<h2>Search anchor<a class="headerlink" href="#search-anchor" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">\G</span></code></p>
<p>A search anchor has been added. It matches at the position where each search started/continued and can be used for contiguous matches or in negative variable-length lookbehinds to limit how far back the lookbehind goes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\w</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;abcd ef&quot;</span><span class="p">)</span>
<span class="go">[&#39;ab&#39;, &#39;cd&#39;, &#39;ef&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\G\w</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;abcd ef&quot;</span><span class="p">)</span>
<span class="go">[&#39;ab&#39;, &#39;cd&#39;]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The search starts at position 0 and matches 2 letters ‘ab’.</p></li>
<li><p>The search continues at position 2 and matches 2 letters ‘cd’.</p></li>
<li><p>The search continues at position 4 and fails to match any letters.</p></li>
<li><p>The anchor stops the search start position from being advanced, so there are no more results.</p></li>
</ul>
</section>
<section id="reverse-searching">
<h2>Reverse searching<a class="headerlink" href="#reverse-searching" title="Permalink to this heading">¶</a></h2>
<p>Searches can now work backwards:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;abc&quot;</span><span class="p">)</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?r).&quot;</span><span class="p">,</span> <span class="s2">&quot;abc&quot;</span><span class="p">)</span>
<span class="go">[&#39;c&#39;, &#39;b&#39;, &#39;a&#39;]</span>
</pre></div>
</div>
<p>Note: the result of a reverse search is not necessarily the reverse of a forward search:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;abcde&quot;</span><span class="p">)</span>
<span class="go">[&#39;ab&#39;, &#39;cd&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?r)..&quot;</span><span class="p">,</span> <span class="s2">&quot;abcde&quot;</span><span class="p">)</span>
<span class="go">[&#39;de&#39;, &#39;bc&#39;]</span>
</pre></div>
</div>
</section>
<section id="matching-a-single-grapheme">
<h2>Matching a single grapheme<a class="headerlink" href="#matching-a-single-grapheme" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">\X</span></code></p>
<p>The grapheme matcher is supported. It now conforms to the Unicode specification at <code class="docutils literal notranslate"><span class="pre">http://www.unicode.org/reports/tr29/</span></code>.</p>
</section>
<section id="branch-reset">
<h2>Branch reset<a class="headerlink" href="#branch-reset" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">(?|...|...)</span></code></p>
<p>Capture group numbers will be reused across the alternatives, but groups with different names will have different group numbers.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?|(first)|(second))&quot;</span><span class="p">,</span> <span class="s2">&quot;first&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="go">(&#39;first&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?|(first)|(second))&quot;</span><span class="p">,</span> <span class="s2">&quot;second&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<span class="go">(&#39;second&#39;,)</span>
</pre></div>
</div>
<p>Note that there is only one group.</p>
</section>
<section id="default-unicode-word-boundary">
<h2>Default Unicode word boundary<a class="headerlink" href="#default-unicode-word-boundary" title="Permalink to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">WORD</span></code> flag changes the definition of a ‘word boundary’ to that of a default Unicode word boundary. This applies to <code class="docutils literal notranslate"><span class="pre">\b</span></code> and <code class="docutils literal notranslate"><span class="pre">\B</span></code>.</p>
</section>
<section id="timeout-python-3">
<h2>Timeout (Python 3)<a class="headerlink" href="#timeout-python-3" title="Permalink to this heading">¶</a></h2>
<p>The matching methods and functions support timeouts. The timeout (in seconds) applies to the entire operation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">fast_replace</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="s1">&#39;X&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">slow_replace</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="s1">&#39;X&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[a-z]&#39;</span><span class="p">,</span> <span class="n">fast_replace</span><span class="p">,</span> <span class="s1">&#39;abcde&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;XXXXX&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regex</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[a-z]&#39;</span><span class="p">,</span> <span class="n">slow_replace</span><span class="p">,</span> <span class="s1">&#39;abcde&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;C:\Python37\lib\site-packages\regex\regex.py&quot;</span>, line <span class="m">276</span>, in <span class="n">sub</span>
    <span class="n">endpos</span><span class="p">,</span> <span class="n">concurrent</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
<span class="gr">TimeoutError</span>: <span class="n">regex timed out</span>
</pre></div>
</div>
</section>
</section>

<div class="section">
   
</div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../../../../../../">
    <img class="logo" src="../../../../../../../../_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">PHOTON platform<br/>•<br/>.vim</h1>
    
  </a>
</p>





<iframe src="https://ghbtns.com/github-btn.html?user=photon-platform&type=follow&count=true&size=large" frameborder="0" scrolling="0" width="230" height="30" title="GitHub"></iframe>


<p>
<iframe src="https://ghbtns.com/github-btn.html?user=photon-platform&repo=vim&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>




<!-- <h3>Navigation</h3> -->


<h3>
  <a href="../../../../../../../../log/">LOG recent</a>
</h3>
<ul>
   
  <li>
    <a href="../../../../../../../../log/22.348-113439/"
      >22.348 - Welcome to the .vim project</a
    >
  </li>
  
</ul>

<h3>
  <a href="../../../../../../../../log/category/">Categories</a>
</h3>
<ul>
   
  <li>
    <a href="../../../../../../../../log/category/status/">STATUS (1)</a>
  </li>
   
</ul>

<h3>
  <a href="../../../../../../../../log/archive/">Archives</a>
</h3>
<ul>
   
  <li>
    <a href="../../../../../../../../log/2022/">2022 (1)</a>
  </li>
   
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../../../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, PHOTON platform.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/photon-platform/photon-sphinx-theme">PHOTON Sphinx 0.0.1</a>
      
      |
      <a href="../../../../../../../../_sources/photon/completion/third_party/ycmd/third_party/mrab-regex/docs/Features.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>